# 8(main)
- **.text section**
	- code section, executable code
- PE header contains "entry point" for the instructions
	- **AddressOfEntryPoint**
- **Packing**
	- Zipping real `.text` section making it harder to analyze statically.
	- Only unpacked when executing (ì •ì ë¶„ì„ ë°©í•´)
	- Tools
		- **UPX**
			- for **compressing** rather than security
		- **Themida**
			- for security, ë°”ì´ë„ˆë¦¬ ë¶„ì„ë°©í•´
			- ê°€ìƒí™”ê¸°ë°˜ ë‚œë…í™” tool
- ë‚œë…í™”
	- ê¸°ëŠ¥ì€ ë™ì¼í•˜ê²Œ, í˜•íƒœë¥¼ ë³µìž¡í•˜ê²Œ
	- ex) **ê·¸ ì‚¬ì‹¤ì„ ì¸ì •í•©ë‹ˆë‹¤ -> ê·¸ ì‚¬ì‹¤ì„ ë¶€ì •í•˜ì§€ ì•Šì„ ìˆ˜ ì—†ì§€ ì•ŠìŠµë‹ˆë‹¤.**
	- Types
		- ì†ŒìŠ¤ì½”ë“œ ë‚œë…í™”
			- ìƒì†Œí•œ ë¬¸ë²• ì´ìš©
			- ex) `x = ( 5 == 5 )`
			- ê°„ë‹¨í•œ ìˆ˜ì‹ ì¼ë¶€ëŸ¬ ë³µìž¡í•˜ê²Œ
			- ê°€ë…ì„± ì €í•˜
		- ë°”ì´ë„ˆë¦¬ ë‚œë…í™”
			- **Basic Block**
				- A chunk of code that is run together
			- **Control Flow Flattening
				- ë² ì´ì§ ë¸”ë¡ ê°„ ì¢…ì†ê´€ê³„ ì§ì ‘ì ìœ¼ë¡œ ë³´ì´ì§€ ì•Šê²Œ ë§Œë“¦
			- ëª…ë ¹ì–´ë¥¼ ë” ë³µìž¡í•œ ë²„ì „ìœ¼ë¡œ
			- Bogus Control Flow (ê°€ì§œ ë¶„ê¸°ë¬¸)
		- ê°€ìƒí™” ê¸°ë°˜ ë‚œë…í™”
			- ê°€ìƒí™” cpuìš© ì½”ë“œ, ë…ìžì   ISA(Instruction Set Architecture)
			- ì¼ë°˜ cpuì—ì„œ ë™ìž‘ ë¶ˆê°€, ì¼ë°˜ reversing ë¶ˆê°€
	- Tools
		- LLVM Obfuscator
			- ì†ŒìŠ¤ì½”ë“œë¥¼ ì»´íŒŒì¼í•˜ëŠ” ê³¼ì •ì—ì„œ ë‚œë…í™”
- ê°€ìƒí™”
	- JVM style ê°€ìƒí™”
	- VMware style ê°€ìƒí™”
	-  ê°€ìƒí™” ê¸°ë°˜ ë‚œë…í™”
- ì•ˆí‹°ë””ë²„ê¹…
	- types
		- API based
			- FindWindow API (using class name)
			- Registry value
			- IsDebuggerPresent API - flag
		- Exception handling based - ðŸ§¨RE
			- INT 3 (CC) scanning - pg.28
			- INT 3 : breakpoint
			- TRAP flag
		- data structure based - ðŸ§¨RE
		- anti-virtualization
			- e.g. virtial box, vmware
			- the criteria is vague now
			- ì•ˆí‹° ë””ë²„ê¹… vs ì•ˆí‹° ê°€ìƒí™”
				- ì•ˆí‹° ê°€ìƒí™” : ê°€ìƒí™” like vmware
		- Direct structure access
		- anti emulation
			- emulation ë°©í•´
			- emulation : hardwareì˜ softwareì  êµ¬í˜„
			- ê°€ìƒí™” vs emulation
				- ê°€ìƒí™” : í•˜ë‚˜ì˜ í•˜ë“œì›¨ì–´ì— ì—¬ëŸ¬ í•˜ë“œì›¨ì–´ íš¨ê³¼
				- emulation : ì—†ëŠ” í•˜ë“œì›¨ì–´ ì†Œí”„íŠ¸ì›¨ì–´ë¡œ í‰ë‚´
			- **DBI**
				- Dynamic Binary Instrumentation
				- emulation ê¸°ë°˜ ê¸°ìˆ 
				- ëª…ë ¹ì–´ ë ˆë²¨ì—ì„œ ë¶„ì„ ë° ìˆ˜ì • ê°€ëŠ¥
	- Examples
		- ê°€ìƒí™”
			- Intel-VT
			- virtualbox
			- vmware
		- emulation
			- Qemu
- flag registers
	- To store status and control info
	- Main ones
		- 0 CF : carry flag
		- 2 PF : Parity flag
		- 6 ZF : zero flag
		- 7 SF : Sign flag
		- 11 OF : Overflow flag

---

# 9
- ì •ì ë¶„ì„ vs ë™ì ë¶„ì„
- decompiler
	- binary to source
- disassembler
	- binary to assembly
- debugging
	- ëŒ€í‘œì  ë™ì ë¶„ì„ ë°©ë²•
	- **breakpoint**
		- single **step** : exec 1 instruction
		- **next** instruction : exec, call is 1 instruction
	- debugger > disassembler
	- Tools
		- GDB
		- IDA
- ì‹¤ìŠµ(pwndbg)
	- args : %edi, %esi, %edx, %ecx
	- `b main`, `b *[address]`(exact)
	- `ni`
	- `i r` : info register
	- `x/[repeat][format, size]`
		- `x/10wx`
- ì‹¤ìŠµ(IDA Pro)
	- disassemble
		- basic
	- breakpoint
		- click on instruction & F2
	- single step
	- Check register
	- memory dump
	- Jump to address
		- type "g" & enter address in hex

---

# 10
- Anti debugging - ptrace
	- How it works?
		- `PTRACE_TRACEME` requests that OS traces the current process.
		- Since debugger is already attatched, another ptrace will fail.
- AntiAnti debugging - LD_PRELOAD
	- How it works?
		- LD_PRELOAD is an env variable that allows a user to specify a `.so` file to be loaded before other shared libraries
		- Commonly used for function hooking and overriding library functions.